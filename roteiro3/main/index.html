
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Silva, J.; Souza, P.">
      
      
        <link rel="canonical" href="https://hsandmann.github.io/insper.cloud.template/roteiro3/main/">
      
      
        <link rel="prev" href="../../roteiro2/main/">
      
      
        <link rel="next" href="../../roteiro4/main/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Roteiro 3 - Computação em Nuvem</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%2032C28.7%2032%200%2060.7%200%2096v320c0%2035.3%2028.7%2064%2064%2064h224V368c0-26.5%2021.5-48%2048-48h112V96c0-35.3-28.7-64-64-64zm384%20320H336c-8.8%200-16%207.2-16%2016v112l32-32%2064-64z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M96%200C43%200%200%2043%200%2096v320c0%2053%2043%2096%2096%2096h320c17.7%200%2032-14.3%2032-32s-14.3-32-32-32v-64c17.7%200%2032-14.3%2032-32V32c0-17.7-14.3-32-32-32H96m0%20384h256v64H96c-17.7%200-32-14.3-32-32s14.3-32%2032-32m32-240c0-8.8%207.2-16%2016-16h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16m16%2048h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16s7.2-16%2016-16%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-40-176h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24m40-208a32%2032%200%201%201%200%2064%2032%2032%200%201%201%200-64%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480%2032c0-12.9-7.8-24.6-19.8-29.6S434.5.2%20425.3%209.3L381.7%2053c-48%2048-113.1%2075-181%2075H64c-35.3%200-64%2028.7-64%2064v96c0%2035.3%2028.7%2064%2064%2064v128c0%2017.7%2014.3%2032%2032%2032h64c17.7%200%2032-14.3%2032-32V352h8.7c67.9%200%20133%2027%20181%2075l43.6%2043.6c9.2%209.2%2022.9%2011.9%2034.9%206.9s19.8-16.6%2019.8-29.6V300.3c18.6-8.8%2032-32.5%2032-60.4s-13.4-51.6-32-60.4zm-64%2076.7v262.6C357.2%20317.8%20280.5%20288%20200.7%20288H192v-96h8.7c79.8%200%20156.5-29.8%20215.3-83.3%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M438.6%20105.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-256%20256c-12.5%2012.5-32.8%2012.5-45.3%200l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200L160%20338.7l233.4-233.3c12.5-12.5%2032.8-12.5%2045.3%200z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-86.2-346.7c7.9-22.3%2029.1-37.3%2052.8-37.3h58.3c34.9%200%2063.1%2028.3%2063.1%2063.1%200%2022.6-12.1%2043.5-31.7%2054.8L280%20264.4c-.2%2013-10.9%2023.6-24%2023.6-13.3%200-24-10.7-24-24v-13.5c0-8.6%204.6-16.5%2012.1-20.8l44.3-25.4c4.7-2.7%207.6-7.7%207.6-13.1%200-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4%200-6.4%202.1-7.5%205.3l-.4%201.2c-4.4%2012.5-18.2%2019-30.6%2014.6s-19-18.2-14.6-30.6l.4-1.2zM224%20352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%2032c14.2%200%2027.3%207.5%2034.5%2019.8l216%20368c7.3%2012.4%207.3%2027.7.2%2040.1S486.3%20480%20472%20480H40c-14.3%200-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7%2039.5%20241.8%2032%20256%2032m0%20128c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V184c0-13.3-10.7-24-24-24m32%20224a32%2032%200%201%200-64%200%2032%2032%200%201%200%2064%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M459.1%2052.4%20442.6%206.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5%202.6-10.4%206.5l-16.5%2045.9-46%2016.8c-4.3%201.6-7.3%205.9-7.2%2010.4%200%204.5%203%208.7%207.2%2010.2l45.7%2016.8%2016.8%2045.8c1.5%204.4%205.8%207.5%2010.4%207.5s8.9-3.1%2010.4-7.5l16.5-45.8%2045.7-16.8c4.2-1.5%207.2-5.7%207.2-10.2%200-4.6-3-8.9-7.2-10.4zm-132.4%2053c-12.5-12.5-32.8-12.5-45.3%200l-2.9%202.9c-22-8-45.8-12.3-70.5-12.3C93.1%2096%200%20189.1%200%20304s93.1%20208%20208%20208%20208-93.1%20208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5%2012.5-32.8%200-45.3l-80-80zM200%20192c-57.4%200-104%2046.6-104%20104v8c0%208.8-7.2%2016-16%2016s-16-7.2-16-16v-8c0-75.1%2060.9-136%20136-136h8c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016z%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20398.9c58.5-41.1%2096-104.1%2096-174.9C512%20100.3%20397.4%200%20256%200S0%20100.3%200%20224c0%2070.7%2037.5%20133.8%2096%20174.9V464c0%2026.5%2021.5%2048%2048%2048h48v-48c0-8.8%207.2-16%2016-16s16%207.2%2016%2016v48h64v-48c0-8.8%207.2-16%2016-16s16%207.2%2016%2016v48h48c26.5%200%2048-21.5%2048-48v-65.1M96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M320%200c17.7%200%2032%2014.3%2032%2032v64h120c39.8%200%2072%2032.2%2072%2072v272c0%2039.8-32.2%2072-72%2072H168c-39.8%200-72-32.2-72-72V168c0-39.8%2032.2-72%2072-72h120V32c0-17.7%2014.3-32%2032-32M208%20384c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zM264%20256a40%2040%200%201%200-80%200%2040%2040%200%201%200%2080%200m152%2040a40%2040%200%201%200%200-80%2040%2040%200%201%200%200%2080M48%20224h16v192H48c-26.5%200-48-21.5-48-48v-96c0-26.5%2021.5-48%2048-48m544%200c26.5%200%2048%2021.5%2048%2048v96c0%2026.5-21.5%2048-48%2048h-16V224z%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v132.8c0%2011.8-3.3%2023.5-9.5%2033.5L10.3%20406.2C3.6%20417.2%200%20429.7%200%20442.6%200%20480.9%2031.1%20512%2069.4%20512h309.2c38.3%200%2069.4-31.1%2069.4-69.4%200-12.8-3.6-25.4-10.3-36.4L329.5%20230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20196.8V64h64v132.8c0%2023.7%206.6%2046.9%2019%2067.1l34.5%2056.1h-171l34.5-56.1c12.4-20.2%2019-43.4%2019-67.1%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64V216m256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64V216%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/badge.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introducao-e-objetivo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Computação em Nuvem" class="md-header__button md-logo" aria-label="Computação em Nuvem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Computação em Nuvem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Roteiro 3
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hsandmann/insper.cloud.template" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github/insper.cloud.template
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Computação em Nuvem" class="md-nav__button md-logo" aria-label="Computação em Nuvem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Computação em Nuvem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hsandmann/insper.cloud.template" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github/insper.cloud.template
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Roteiros
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Roteiros
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roteiro1/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roteiro 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roteiro2/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roteiro 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Roteiro 3
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Roteiro 3
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introducao-e-objetivo" class="md-nav__link">
    <span class="md-ellipsis">
      Introdução e Objetivo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#montagem-do-roteiro" class="md-nav__link">
    <span class="md-ellipsis">
      Montagem do Roteiro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infra" class="md-nav__link">
    <span class="md-ellipsis">
      Infra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parte-0-detalhamento-dos-servicos-implantados-na-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 0: Detalhamento dos serviços implantados na cloud
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parte-1-autenticacao" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 1: Autenticação
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-2-horizon" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 2: Horizon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-3-imagens-e-flavors" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 3: Imagens e Flavors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-4-rede-externa" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 4: Rede Externa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-5-rede-interna-e-roteador" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 5: Rede Interna e Roteador
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-6-conexao" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 6: Conexão
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-7-instancia" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 7: Instância
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      Checkpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escalando-os-nos" class="md-nav__link">
    <span class="md-ellipsis">
      Escalando os nós
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#desenho-da-arquitetura-de-rede" class="md-nav__link">
    <span class="md-ellipsis">
      Desenho da arquitetura de rede
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app" class="md-nav__link">
    <span class="md-ellipsis">
      App
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparacao-da-arquitetura" class="md-nav__link">
    <span class="md-ellipsis">
      Preparação da arquitetura
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-da-instancia-loadbalancer" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração da instância LoadBalancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacao-do-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Instalação do Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-das-instancias-de-api" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração das instâncias de API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-da-instancia-do-banco-de-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração da instância do Banco de Dados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacao-final" class="md-nav__link">
    <span class="md-ellipsis">
      Verificação final
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roteiro4/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roteiro 4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../projeto/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Projeto
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introducao-e-objetivo" class="md-nav__link">
    <span class="md-ellipsis">
      Introdução e Objetivo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#montagem-do-roteiro" class="md-nav__link">
    <span class="md-ellipsis">
      Montagem do Roteiro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infra" class="md-nav__link">
    <span class="md-ellipsis">
      Infra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parte-0-detalhamento-dos-servicos-implantados-na-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 0: Detalhamento dos serviços implantados na cloud
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parte-1-autenticacao" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 1: Autenticação
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-2-horizon" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 2: Horizon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-3-imagens-e-flavors" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 3: Imagens e Flavors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-4-rede-externa" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 4: Rede Externa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-5-rede-interna-e-roteador" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 5: Rede Interna e Roteador
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-6-conexao" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 6: Conexão
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parte-7-instancia" class="md-nav__link">
    <span class="md-ellipsis">
      Parte 7: Instância
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      Checkpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escalando-os-nos" class="md-nav__link">
    <span class="md-ellipsis">
      Escalando os nós
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#desenho-da-arquitetura-de-rede" class="md-nav__link">
    <span class="md-ellipsis">
      Desenho da arquitetura de rede
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app" class="md-nav__link">
    <span class="md-ellipsis">
      App
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparacao-da-arquitetura" class="md-nav__link">
    <span class="md-ellipsis">
      Preparação da arquitetura
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-da-instancia-loadbalancer" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração da instância LoadBalancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacao-do-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Instalação do Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-das-instancias-de-api" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração das instâncias de API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-da-instancia-do-banco-de-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Configuração da instância do Banco de Dados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacao-final" class="md-nav__link">
    <span class="md-ellipsis">
      Verificação final
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h2 id="introducao-e-objetivo"><b>Introdução e Objetivo</b></h2>
<p align="justify">
O roteiro 3 contempla uma abordagem nova, mantendo a utlização do Juju para gerenciamento de aplicações distribuídas mas introduzindo agora o openstack.
</p>

<p align="justify">
Ao final deste roteiro, o objetivo principal é termos, portanto, uma Cloud com um novo gerenciador de deploy instalado, utilizando o OpenStack como plataforma de nuvem privada. 
</p>

<p align="justify"> 
O roteiro é dividido em três etapas: criação da infraestrutura (deploy do OpenStack), configuração dos serviços e redes da nuvem, e, por fim, a utilização da infraestrutura com o deployment de aplicações dentro de máquinas virtuais gerenciadas pela nuvem OpenStack.
</p>

<h2 id="montagem-do-roteiro"><b>Montagem do Roteiro</b></h2>
<p align="justify">
Todo roteiro apresenta uma primeira parte denominada <b>Infra</b> e uma segunda chamada de <b>App</b>.
No caso deste roteiro especificamente, também há uma seção intermediária de configuração prévia para o App, denominada de <b>Setup</b>.
Os pontos <b>tarefas</b> dentro de cada parte são os passos seguidos para a realização do roteiro. 
Este modelo de organização orientado por partes e tarefas será utilizado em <b>todos os roteiros</b>.
</p>

<h1 id="infra"><b>Infra</b></h1>
<h2 id="parte-0-detalhamento-dos-servicos-implantados-na-cloud"><b>Parte 0: Detalhamento dos serviços implantados na cloud</b></h2>
<p align="justify">
Foi implantada uma infraestrutura de nuvem privada utilizando OpenStack, orquestrada com MAAS e Juju, e com armazenamento distribuído via Ceph. Antes de tudo, foi necessário garantir que todas as bridges da nossa nuvem estavam corretamente configuradas com a denominação "br-ex", já que esta é a interface de rede que conectará o OpenStack à rede externa.
</p>

<p align="justify"> 
Também, foi utilizada a interface do MaaS para garantir as especificações necessárias para as nossas máquinas físicas que estão listadas a seguir:
</p>

<table>
<thead>
<tr>
<th>Servidor</th>
<th>Tags</th>
<th>CPUs</th>
<th>NICs</th>
<th>RAM</th>
<th>Disks</th>
<th>Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td>server1</td>
<td>controller, juju</td>
<td>2</td>
<td>1</td>
<td>12</td>
<td>1</td>
<td>80</td>
</tr>
<tr>
<td>server2</td>
<td>reserva</td>
<td>2</td>
<td>1</td>
<td>16</td>
<td>2</td>
<td>80</td>
</tr>
<tr>
<td>server3</td>
<td>compute</td>
<td>2</td>
<td>1</td>
<td>32</td>
<td>2</td>
<td>80</td>
</tr>
<tr>
<td>server4</td>
<td>compute</td>
<td>2</td>
<td>1</td>
<td>32</td>
<td>2</td>
<td>80</td>
</tr>
<tr>
<td>server5</td>
<td>compute</td>
<td>2</td>
<td>1</td>
<td>32</td>
<td>2</td>
<td>80</td>
</tr>
</tbody>
</table>
<p align="justify"> 
Por fim, foi definido o modelo do deploy e seguido <a href="https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/install-openstack.html" target="_blank">o tutorial oficial do OpenStack</a> para instalar as seguintes dependências: 
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>juju<span class="w"> </span>add-model<span class="w"> </span>--config<span class="w"> </span>default-series<span class="o">=</span>jammy<span class="w"> </span>openstack
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>juju<span class="w"> </span>switch<span class="w"> </span>maas-controller:openstack
</span></code></pre></div>
<ul>
<li>Ceph OSD</li>
<li>Nova Compute</li>
<li>MySQL InnoDB Cluster</li>
<li>Vault</li>
<li>Neutron Networking</li>
<li>Keystone </li>
<li>RabbitMQ</li>
<li>Nova Cloud Controller</li>
<li>Placement</li>
<li>Horizon - OpenStack Dashboard</li>
<li>Glance </li>
<li>Ceph Monitor</li>
<li>Cinder</li>
<li>Ceph RADOS Gateway</li>
</ul>
<p>Com as devidas integrações realizadas, foi executado um último comando de finalização da Infra:</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>juju<span class="w"> </span>config<span class="w"> </span>ceph-osd<span class="w"> </span>osd-devices<span class="o">=</span><span class="s1">&#39;/dev/sdb&#39;</span>
</span></code></pre></div>
<h1 id="setup"><b>Setup</b></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setup baseado na documentação oficial do openstack: <a href="https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/configure-openstack.html">https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/configure-openstack.html</a></p>
</div>
<p>No setup, foi feita a configuração dos serviços que controlam:</p>
<ul>
<li>as VMs (Nova);</li>
<li>os volumes de disco (Cinder);</li>
<li>a estrutura de rede virtual (Neutron).</li>
</ul>
<h2 id="parte-1-autenticacao"><b>Parte 1: Autenticação</b></h2>
<p align="justify">
Antes de configurar Nova, Cinder e Neutron, é preciso realizar a autenticação no <i>Keystone</i>.
</p>

<p align="justify">
Para isso, foi criado um arquivo <code>openrc.sh</code> contendo as variáveis de ambiente necessárias para que a CLI do OpenStack possa se autenticar automaticamente.
</p>

<p align="justify">
Sempre que for necessário fazer alguma modificação no OpenStack via terminal, é preciso carregar nossas credenciais, presentes no arquivo criado, e obter as permissões necessárias. Para isso, foi utilizado o comando:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">source</span><span class="w"> </span>~/openrc
</span></code></pre></div>
<p align="justify">
Para confirmar que as variáveis de ambiente foram carregadas, rodamos o seguinte comando:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>env<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>OS_
</span></code></pre></div>
<p align="justify">
Isso deve retornar todas as variáveis <code>OS_</code>, como no exemplo a seguir: 
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">OS_AUTH_URL</span><span class="o">=</span>https://<span class="o">{</span>KEYSTONE_IP<span class="o">}</span>:5000/v3
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">OS_USERNAME</span><span class="o">=</span>admin
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nv">OS_PASSWORD</span><span class="o">=</span>MY_PASSWORD
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nv">OS_USER_DOMAIN_NAME</span><span class="o">=</span>admin_domain
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nv">OS_PROJECT_NAME</span><span class="o">=</span>admin
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nv">OS_PROJECT_DOMAIN_NAME</span><span class="o">=</span>admin_domain
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nv">OS_AUTH_VERSION</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nv">OS_IDENTITY_API_VERSION</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="nv">OS_REGION_NAME</span><span class="o">=</span>RegionOne
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nv">OS_AUTH_PROTOCOL</span><span class="o">=</span>https
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="nv">OS_CACERT</span><span class="o">=</span>/home/ubuntu/.../root-ca.crt
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="nv">OS_AUTH_TYPE</span><span class="o">=</span>password
</span></code></pre></div>
<h2 id="parte-2-horizon"><b>Parte 2: Horizon</b></h2>
<p align="justify">
Para acessar o Horizon (<i>Dashboard</i>), foi criado um túnel via <code>ssh</code> até onde o serviço se encontrava:
</p>

<figure>
<p><a class="glightbox" href="../img/tunel_horizon.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Horizon - Juju Status" src="../img/tunel_horizon.jpeg" /></a></p>
<figcaption>
<p>Endereço IP e porta do Horizon, no Juju Status</p>
</figcaption>
</figure>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ssh<span class="w"> </span>cloud@<span class="o">{</span>IP_MAIN<span class="o">}</span><span class="w"> </span>-L<span class="w"> </span><span class="m">8001</span>:<span class="o">{</span>IP_DASHBOARD<span class="o">}</span>:<span class="o">{</span>PORTA_DASHBOARD<span class="o">}</span>
</span></code></pre></div>
<p align="justify">
Após isso, no navegador (<a href="http://localhost:8001/horizon">http://localhost:8001/horizon</a>), foi possível entrar no Horizon Dashboard utilizando as credenciais:
</p>

<ul>
<li><strong>Login</strong>: <code>admin</code></li>
<li><strong>Senha</strong>: <code>OS_PASSWORD</code> visível no <code>openrc.sh</code></li>
<li><strong>Domain</strong>: <code>admin_domain</code></li>
</ul>
<p align="justify">
Acessando o Horizon, é possível encontrar algo parecido com isso: 
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa1.3.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 1.3" src="../img/tarefa1.3.jpeg" /></a></p>
<figcaption>
<p>Aba compute <strong>overview</strong> no <strong>OpenStack</strong> Dashboard.</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa1.4.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 1.4" src="../img/tarefa1.4.jpeg" /></a></p>
<figcaption>
<p>Aba compute <strong>instances</strong> no <strong>OpenStack</strong> Dashboard.</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa1.5.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 1.5" src="../img/tarefa1.5.jpeg" /></a></p>
<figcaption>
<p>Aba network <strong>topology</strong> no <strong>OpenStack</strong> Dashboard.</p>
</figcaption>
</figure>
<p align="justify">
Além disso, no Juju status e no Dashboard do <b>MAAS</b> as alocações das máquinas se encontravam da seguinte forma:
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa1.1.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 1.1" src="../img/tarefa1.1.jpeg" /></a></p>
<figcaption>
<p>Juju Status</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa1.2.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 1.2" src="../img/tarefa1.2.jpeg" /></a></p>
<figcaption>
<p>Dashboard do <strong>MAAS</strong> com as máquinas alocadas.</p>
</figcaption>
</figure>
<h2 id="parte-3-imagens-e-flavors"><b>Parte 3: Imagens e Flavors</b></h2>
<p align="justify">
A partir desse ponto, foi necessário instalar o <b>client</b> do <i>Openstack</i> no main via snap.
</p>

<p align="justify">
O comando utilizado foi o seguinte:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>snap<span class="w"> </span>install<span class="w"> </span>openstackclients
</span></code></pre></div>
<p align="justify">
Carregamos as credenciais, como feito anteriormente via <code>source</code>, e verificamos os serviços disponíveis no Openstack, para garantir que o ambiente estava setado corretamente.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>openstack<span class="w"> </span>service<span class="w"> </span>list
</span></code></pre></div>
<figure>
<p><a class="glightbox" href="../img/openstack_service.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Openstack service list" src="../img/openstack_service.jpeg" /></a></p>
<figcaption>
<p>Serviços disponíveis no <strong>Openstack</strong></p>
</figcaption>
</figure>
<p align="justify">
Além disso, foi necessário realizar alguns pequenos ajustes na rede antes de prosseguir:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>juju<span class="w"> </span>config<span class="w"> </span>neutron-api<span class="w"> </span>enable-ml2-dns<span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>juju<span class="w"> </span>config<span class="w"> </span>neutron-api-plugin-ovn<span class="w"> </span>dns-servers<span class="o">=</span><span class="s2">&quot;172.16.0.1&quot;</span>
</span></code></pre></div>
<p align="justify">
Baixamos a imagem de boot do Ubuntu Jammy amd64 com o comando:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Cria diretorio para salvar a imagem</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>mkdir<span class="w"> </span>~/cloud-images
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Baixa imagem do Jammy </span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>wget<span class="w"> </span>http://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">   </span>-O<span class="w"> </span>~/cloud-images/jammy-amd64.img
</span></code></pre></div>
<p align="justify">
Então importamos a imagem para o serviço <b>Glance</b> do Openstack e o chamamos de <code>jammy-amd64</code>, via:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>openstack<span class="w"> </span>image<span class="w"> </span>create<span class="w"> </span>--public<span class="w"> </span>--container-format<span class="w"> </span>bare<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">   </span>--disk-format<span class="w"> </span>qcow2<span class="w"> </span>--file<span class="w"> </span>~/cloud-images/jammy-amd64.img<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">   </span>jammy-amd64
</span></code></pre></div>
<p align="justify">
Para finalizar, criamos os <b>flavors</b>:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>openstack<span class="w"> </span>flavor<span class="w"> </span>create<span class="w"> </span>--vcpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">1024</span><span class="w"> </span>--disk<span class="w"> </span><span class="m">20</span><span class="w">  </span>m1.tiny<span class="w">    </span><span class="c1"># 1 GB</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>openstack<span class="w"> </span>flavor<span class="w"> </span>create<span class="w"> </span>--vcpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">2048</span><span class="w"> </span>--disk<span class="w"> </span><span class="m">20</span><span class="w">  </span>m1.small<span class="w">   </span><span class="c1"># 2 GB</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>openstack<span class="w"> </span>flavor<span class="w"> </span>create<span class="w"> </span>--vcpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">4096</span><span class="w"> </span>--disk<span class="w"> </span><span class="m">20</span><span class="w">  </span>m1.medium<span class="w">  </span><span class="c1"># 4 GB</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>openstack<span class="w"> </span>flavor<span class="w"> </span>create<span class="w"> </span>--vcpus<span class="w"> </span><span class="m">4</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">8192</span><span class="w"> </span>--disk<span class="w"> </span><span class="m">20</span><span class="w">  </span>m1.large<span class="w">   </span><span class="c1"># 8 GB</span>
</span></code></pre></div>
<h2 id="parte-4-rede-externa"><b>Parte 4: Rede Externa</b></h2>
<p align="justify">
Neste passo, criamos uma <b>Rede externa</b> (<i>pública</i>), <code>ext_net</code>.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>openstack<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>--external<span class="w"> </span>--share<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">   </span>--provider-network-type<span class="w"> </span>flat<span class="w"> </span>--provider-physical-network<span class="w"> </span>physnet1<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">   </span>ext_net
</span></code></pre></div>
<p align="justify">
Para configurar a rede externa, estabelecemos uma faixa de alocação entre <code>172.16.7.0</code> e <code>172.16.8.255</code>.
</p>

<p align="justify">
Isso foi feito a partir da criação de uma <b>Subnet</b>, <code>ext_subnet</code>, utilizando o comando:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>openstack<span class="w"> </span>subnet<span class="w"> </span>create<span class="w"> </span>--network<span class="w"> </span>ext_net<span class="w"> </span>--no-dhcp<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">   </span>--gateway<span class="w"> </span><span class="m">172</span>.16.0.1<span class="w"> </span>--subnet-range<span class="w"> </span><span class="m">172</span>.16.7.0/20<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">   </span>--allocation-pool<span class="w"> </span><span class="nv">start</span><span class="o">=</span><span class="m">172</span>.16.7.0,end<span class="o">=</span><span class="m">172</span>.16.8.255<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">   </span>ext_subnet
</span></code></pre></div>
<h2 id="parte-5-rede-interna-e-roteador"><b>Parte 5: Rede Interna e Roteador</b></h2>
<p align="justify">
Após criar a Rede externa, criamos a <b>Rede Interna</b> (<i>privada</i>) e <b>Roteador</b>.
</p>

<p align="justify">
Para a <b>Rede Interna</b>, foi criada uma <b>Rede</b>, <code>user1_net</code>, e uma <b>Subnet</b>, <code>user1_subnet</code>, com range <code>192.169.0.0/24</code>.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Rede Interna</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>openstack<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>--internal<span class="w"> </span>user1_net
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Subnet</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>openstack<span class="w"> </span>subnet<span class="w"> </span>create<span class="w"> </span>--network<span class="w"> </span>user1_net<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">   </span>--subnet-range<span class="w"> </span><span class="m">192</span>.169.0.0/24<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">   </span>--allocation-pool<span class="w"> </span><span class="nv">start</span><span class="o">=</span><span class="m">192</span>.169.0.2,end<span class="o">=</span><span class="m">192</span>.169.0.254<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">   </span>user1_subnet
</span></code></pre></div>
<p align="justify">
Agora, para criar o <b>Roteador</b>, foi utilizado o comando:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>openstack<span class="w"> </span>router<span class="w"> </span>create<span class="w"> </span>user1_router
</span></code></pre></div>
<p align="justify">
Para finalizar, foi adicionado a <b>subnet privada</b> e configurado para que use a <b>Rede Externa</b> como gateway:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>openstack<span class="w"> </span>router<span class="w"> </span>add<span class="w"> </span>subnet<span class="w"> </span>user1_router<span class="w"> </span>user1_subnet
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>openstack<span class="w"> </span>router<span class="w"> </span><span class="nb">set</span><span class="w"> </span>user1_router<span class="w"> </span>--external-gateway<span class="w"> </span>ext_net
</span></code></pre></div>
<h2 id="parte-6-conexao"><b>Parte 6: Conexão</b></h2>
<p align="justify">
Antes de criar as instâncias, é necessário ter uma forma de acessá-las.
</p>

<p align="justify">
O <i>key-pair</i> é uma chave pública que permite o acesso SSH seguro às instâncias criadas no OpenStack. Ao importar a chave pública, você pode se conectar às instâncias sem precisar usar senhas, aumentando a segurança e facilitando o gerenciamento de acesso.
</p>

<p align="justify">
Por conta disso, foi criado um diretório onde seriam armazenadas essas chaves e, depois disso, importamos um <b>Keypair</b> usando <i>public key</i> (<code>id_rsa.pub</code>) da máquina onde está o <b>MaaS</b>.
</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A criação dessa <em>public key</em> foi realizada no <strong>Roteiro 1</strong>.</p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Cria o diretório</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>mkdir<span class="w"> </span>~/cloud-keys
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># Pega a chave na main e cria o Keypair</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>openstack<span class="w"> </span>keypair<span class="w"> </span>create<span class="w"> </span>--public-key<span class="w"> </span>~/.ssh/id_rsa.pub<span class="w"> </span>user1
</span></code></pre></div>
<p align="justify">
Para realizar a liberação do <code>SSH</code> e <code>ALL ICMP</code>, entramos no Horizon (<i>dashboard</i>) e modificamos o <i>security group <b>default</b></i>.
</p>

<h2 id="parte-7-instancia"><b>Parte 7: Instância</b></h2>
<p align="justify">
Para finalizar o setup, foi disparado uma instância <code>m1.tiny</code> (<i>flavor</i>), utilizando o nome <i>client</i> e <b>sem</b> Novo Volume.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>openstack<span class="w"> </span>server<span class="w"> </span>create<span class="w"> </span>--image<span class="w"> </span>jammy-amd64<span class="w"> </span>--flavor<span class="w"> </span>m1.tiny<span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">   </span>--key-name<span class="w"> </span>user1<span class="w"> </span>--network<span class="w"> </span>user1_net<span class="w"> </span>--security-group<span class="w"> </span>default<span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">   </span>client
</span></code></pre></div>
<p align="justify">
Após isso, foi <b>solicitado</b> e <b>alocado</b> um floating IP para a instância.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Solicita um FLOATING_IP</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nv">FLOATING_IP</span><span class="o">=</span><span class="k">$(</span>openstack<span class="w"> </span>floating<span class="w"> </span>ip<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>value<span class="w"> </span>-c<span class="w"> </span>floating_ip_address<span class="w"> </span>ext_net<span class="k">)</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Aloca o FLOATING_IP a instância</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>openstack<span class="w"> </span>server<span class="w"> </span>add<span class="w"> </span>floating<span class="w"> </span>ip<span class="w"> </span>client<span class="w"> </span><span class="nv">$FLOATING_IP</span>
</span></code></pre></div>
<p align="justify">
Para verificar se a instância foi <b>criada</b> e <b>configurada</b> corretamente, a listagem de instâncias dentro do projeto e testamos a conexão via <code>SSH</code>.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Mostra a listagem de todas as instâncias criadas</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>openstack<span class="w"> </span>server<span class="w"> </span>list
</span></code></pre></div>
<p align="justify">
O comando anterior deveria devolver algo assim:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>+--------------------------------------+--------+--------+--------------------------------------+-------------+---------+
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="p">|</span><span class="w"> </span>ID<span class="w">                                   </span><span class="p">|</span><span class="w"> </span>Name<span class="w">   </span><span class="p">|</span><span class="w"> </span>Status<span class="w"> </span><span class="p">|</span><span class="w"> </span>Networks<span class="w">                             </span><span class="p">|</span><span class="w"> </span>Image<span class="w">       </span><span class="p">|</span><span class="w"> </span>Flavor<span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>+--------------------------------------+--------+--------+--------------------------------------+-------------+---------+
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="p">|</span><span class="w"> </span>a631ff73-b997-4972-9d03-fc376a882120<span class="w"> </span><span class="p">|</span><span class="w"> </span>client<span class="w"> </span><span class="p">|</span><span class="w"> </span>ACTIVE<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">user1_net</span><span class="o">=</span><span class="m">172</span>.16.8.193,<span class="w"> </span><span class="m">192</span>.169.0.73<span class="w"> </span><span class="p">|</span><span class="w"> </span>jammy-amd64<span class="w"> </span><span class="p">|</span><span class="w"> </span>m1.tiny<span class="w"> </span><span class="p">|</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>+--------------------------------------+--------+--------+--------------------------------------+-------------+---------+
</span></code></pre></div>
<p align="justify">
Já para o teste de conexão via <code>SSH</code>:
</p>

<figure>
<p><a class="glightbox" href="../img/teste_SSH.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Teste SSH" src="../img/teste_SSH.jpeg" /></a></p>
<figcaption>
<p>Teste de conexão via <b>SSH</b></p>
</figcaption>
</figure>
<h2 id="checkpoint">Checkpoint</h2>
<p align="justify">
Após a criação dos <b>flavors</b>, das <b>Redes</b> (<b>Interna</b> e <b>Externa</b>) e da <b>Instância</b>, além da criação do <b>Keypair</b>, é possível ver uma notável diferença nas abas do Horizon.
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa2.1.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 2.1" src="../img/tarefa2.1.jpeg" /></a></p>
<figcaption>
<p>Dashboard <strong>MAAS</strong>, após setup</p>
</figcaption>
</figure>
<p align="justify">
Na Aba compute <b>overview</b> do <b>Horizon</b>, é possível notar a mudança no gráfico de <b>Instances</b>, <b>VCPUs</b> e <b>RAM</b>, isso se deve a criação da nova instância <code>client</code> que criamos no projeto e, no caso da <b>RAM</b> e <b>VCPUs</b>, as especifícações que demos ao <b>flavor</b> (<code>m1.tiny</code>) utilizado na instância.
</p>

<p align="justify">
Além disso, na parte inferior do <b>Compute > Overview</b>, na seção de <b>Network</b>, agora mostra a existência de um <b>floating IP</b> (referente a <code>Parte 7: Instância</code>), 
de duas novas <b>Networks</b> (<code>Parte 4: Rede Externa</code> e <code>Parte 5: Rede Interna</code>), um novo <b>Router</b> (<code>Parte 5: Roteador</code>) e também de um <b>Security Group</b>, o grupo <code>default</code> criado por padrão pelo OpenStack, além das regras atreladas a esse grupo, algumas criadas automaticamente e outras configuradas manualmente, <code>SSH</code> e <code>ALL ICMP</code> (<code>Parte 6: Conexão</code>).
</p>

<p align="justify">
Para os 4 novos <b>Ports</b>:
<ul>
    <li>
        <p align="justify">
            Port de <code>client</code> na rede <code>user1_net</code>, ao subir a <b>instância</b>.
        </p>
    </li>
    <li>
        <p align="justify">
            Port do <b>roteador</b> <code>user1_router</code> → <code>user1_subnet</code> (final de <code>Parte 5: Roteador</code>).
        </p>
    </li>
    <li>
        <p align="justify">
            Port do <b>roteador</b> <code>user1_router</code> → <b>Gateway externo</b> (<code>ext_net</code>) (final de <code>Parte 5: Roteador</code>).
        </p>
    </li>
    <li>
        <p align="justify">
            Port do <b>Floating IP</b> (<code>Parte 7: Instância</code>).
        </p>
    </li>
</ul>
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa2.2.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 2.2" src="../img/tarefa2.2.jpeg" /></a></p>
<figcaption>
<p>Aba compute <strong>overview</strong> do <strong>OpenStack</strong>, após setup</p>
</figcaption>
</figure>
<p align="justify">
Na aba <b>Compute > Instances</b>, assim como na <b>Overview</b>, podemos perceber que agora foi registrado a criação da instância <code>client</code>.
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa2.3.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 2.3" src="../img/tarefa2.3.jpeg" /></a></p>
<figcaption>
<p>Aba compute <strong>instances</strong> do <strong>OpenStack</strong>, após setup</p>
</figcaption>
</figure>
<p align="justify">
Na aba <b>Network Topology</b>, é possível verificar de forma visual todas as ligações feitas entre os objetos em cada passo.
</p>

<p align="justify">
As colunas coloridas são referentes as <b>Redes</b>: <code>user1_net</code> (laranja, <b>Rede Interna</b>) e <code>ext_net</code> (azul, <b>Rede Externa</b>).
</p>

<p align="justify">
O <code>user1_router</code>, seria o roteador (<code>Parte 5: Roteador</code>). O IP a sua direita, conectando o roteador a Rede Interna, seria seu <b>IP Interno</b> <code>192.169.0.1</code>, já o IP a sua esquerda, conectando o roteador a Rede Externa, seria seu <b>IP Externo</b> <code>172.16.7.118</code>.
</p>

<p align="justify">
A direita do diagrama, é possível ver a <b>instância</b> <code>client</code>, criada na <code>Parte 7: Instância</code>, juntamente a seu IP atribuido na subnet de <code>user1_net</code>, com valor <code>192.169.0.73</code>.
</p>

<figure>
<p><a class="glightbox" href="../img/tarefa2.4.jpeg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tarefa 2.4" src="../img/tarefa2.4.jpeg" /></a></p>
<figcaption>
<p>Aba network <strong>topology</strong> do <strong>OpenStack</strong>, após setup</p>
</figcaption>
</figure>
<h2 id="escalando-os-nos">Escalando os nós</h2>
<p align="justify">
Após verificar se ainda há disponibilidade de alguma máquina no <i>Dashboard</i> do <b>MaaS</b>, alguma máquina que ainda esteja somente <i>allocated</i>, fizemos release desta máquina para poder seguir ao passo final: instalar o <b>Hipervisor</b>.
</p>

<p align="justify">
Após finalizar o realease da máquina, utilizamos o comando a seguir para instalar o <code>hypervisor</code> e realizar o deploy na máquina.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>juju<span class="w"> </span>add-unit<span class="w"> </span>nova-compute
</span></code></pre></div>
<p align="justify">
Verificando o <i>juju status</i>, anotamos o número da máquina adicionada e fizemos a instalação do <code>block storage</code>.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>juju<span class="w"> </span>add-unit<span class="w"> </span>--to<span class="w"> </span>&lt;ID_MAQUINA&gt;<span class="w"> </span>ceph-osd
</span></code></pre></div>
<h2 id="desenho-da-arquitetura-de-rede">Desenho da arquitetura de rede</h2>
<p><strong>Tarefa 3) Desenho da arquitetura de rede, desde a sua conexão com o Insper até a instância alocada.</strong></p>
<figure>
<p><a class="glightbox" href="../img/desenho_rede_tarefa3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Arquitetura da rede" src="../img/desenho_rede_tarefa3.png" /></a></p>
<figcaption>
<p>Arquitetura de rede</p>
</figcaption>
</figure>
<h1 id="app"><b>App</b></h1>
<h2 id="preparacao-da-arquitetura"><b>Preparação da arquitetura</b></h2>
<p align="justify">
A principal tarefa a ser completada no App foi a utilização da infraestrutura configurada até o momento para colocar o projeto da disciplina na cloud criada. 
</p>

<p align="justify"> 
Desenvolvido em paralelo, o projeto da disciplina — disponível <a href="https://github.com/antoniolma/insper.cloud-projeto" target="_blank">neste repositório</a> — consistiu em uma aplicação FastAPI composta por três endpoints simples. Para simular uma nuvem mais próxima da realidade, foi adotada a seguinte topologia: 
</p>

<ul>
<li>2 instâncias com a API desenvolvida;</li>
<li>1 instância com banco de dados Postgres;</li>
<li>1 instância com LoadBalancer, Nginx.</li>
</ul>
<p align="justify"> 
Em ambientes de produção, utilizar duas instâncias da API é considerado uma boa prática, pois permite garantir balanceamento de carga, tolerância a falhas e alta disponibilidade. Dessa forma, em vez de a requisição do cliente chegar diretamente a uma instância da API, ela é encaminhada primeiro ao Load Balancer, que distribui as requisições entre as instâncias disponíveis, as quais estão conectadas ao banco de dados da aplicação. A seguir, apresenta-se um diagrama que ilustra essa arquitetura: 
</p>

<figure>
<p><a class="glightbox" href="../img/app_roteiro3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="App do Roteiro 3" src="../img/app_roteiro3.png" /></a></p>
<figcaption>
<p>Topologia de uso da infraestrutura</p>
</figcaption>
</figure>
<p align="justify"> 
Para iniciar a implementação, o dashboard do Horizon foi acessado (via NAT) e, nele, foram criadas as quatro instâncias com os seguintes nomes: load-balancer, api-1, api-2 e database.
</p>

<figure>
<p><a class="glightbox" href="../img/horizon_instances.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Instâncias- Horizon" src="../img/horizon_instances.png" /></a></p>
<figcaption>
<p>Local de visualização e criação de instâncias no dashboard do Horizon</p>
</figcaption>
</figure>
<p align="justify"> 
Após criadas as instâncias, foi necessário atribuir a cada uma um IP Flutuante para que fosse possível atingir todas por meio da NUC Main. Afinal, conforme mostrado no diagrama de topologia da rede anteriormente, as instâncias se encontram em uma subrede e possuem IPs que não são úteis para conversar com máquinas que se encontram na rede externa.
</p>

<p align="justify">
Para isso, foram atribuídos IPs flutuantes para cada instância (uma por vez), reutilizando os comandos vistos no Setup: 
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nv">FLOATING_IP</span><span class="o">=</span><span class="k">$(</span>openstack<span class="w"> </span>floating<span class="w"> </span>ip<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>value<span class="w"> </span>-c<span class="w"> </span>floating_ip_address<span class="w"> </span>ext_net<span class="k">)</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>openstack<span class="w"> </span>server<span class="w"> </span>add<span class="w"> </span>floating<span class="w"> </span>ip<span class="w"> </span>nome-da-instancia<span class="w"> </span><span class="nv">$FLOATING_IP</span>
</span></code></pre></div>
<p align="justify">
Além disso, vale ressaltar que, a fim de baratear o custo de manutenção da arquitetura ao máximo sem prejudicar o desempenho do cliente, optou-se pelo flavor m1.tiny para todas as instâncias. 
</p>

<p align="justify">
Contudo, para aplicações com maior demanda e um volume de dados maior para armazenamento, seria provável a necessidade de escolher flavors maiores do que uma aplicação em ambiente controlado de aprendizado. Afinal, em uma cloud comercial, o custo é proporcional ao tamanho do flavor e seu tempo de uso.
</p>

<h2 id="configuracao-da-instancia-loadbalancer"><b>Configuração da instância LoadBalancer</b></h2>
<p align="justify">
Primeiramente, foi instalado o Nginx por meio do seguinte comandos:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>nginx
</span></code></pre></div>
<p align="justify">
Em seguida, foi necessário editar o arquivo que permitiria o nginx a enxergar as duas instâncias para as quais o Load Balancer apontaria, conforme o diagrama ilustrado no início do relatório:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Acessando arquivo de configuração do nginx</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/default
</span></code></pre></div>
<p align="justify">
Dentro do arquivo, as alterações feitas foram as seguintes:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>upstream<span class="w"> </span>backend<span class="w"> </span><span class="o">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">        </span>server<span class="w"> </span><span class="o">[</span>IP<span class="w"> </span>de<span class="w"> </span>subrede<span class="w"> </span>da<span class="w"> </span>instância<span class="w"> </span>da<span class="w"> </span>API<span class="w"> </span><span class="m">1</span><span class="o">]</span>:8080<span class="p">;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">        </span>server<span class="w"> </span><span class="o">[</span>IP<span class="w"> </span>de<span class="w"> </span>subrede<span class="w"> </span>da<span class="w"> </span>instância<span class="w"> </span>da<span class="w"> </span>API<span class="w"> </span><span class="m">2</span><span class="o">]</span>:8080<span class="p">;</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="o">}</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>server<span class="w"> </span><span class="o">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">        </span>listen<span class="w"> </span><span class="m">80</span><span class="w"> </span>default_server<span class="p">;</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">        </span>listen<span class="w"> </span><span class="o">[</span>::<span class="o">]</span>:80<span class="w"> </span>default_server<span class="p">;</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">        </span>location<span class="w"> </span>/<span class="w"> </span><span class="o">{</span><span class="w"> </span>proxy_pass<span class="w"> </span>http://backend<span class="p">;</span><span class="w"> </span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="o">}</span>
</span></code></pre></div>
<p align="justify">
Por fim, o serviço do nginx foi devidamente reinicializado para salvar as alterações feitas no arquivo:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>sudo<span class="w"> </span>service<span class="w"> </span>nginx<span class="w"> </span>restart
</span></code></pre></div>
<h2 id="instalacao-do-docker"><b>Instalação do Docker</b></h2>
<p align="justify">
Tanto para as instâncias de API quanto para o banco de dados, foi necessário realizar a instalação do docker. Afinal, puxaremos a mesma imagem para as duas instâncias de API do projeto pelo docker hub. Para isso, foi seguido o tutorial oficial no <a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank">site do docker</a>. Os comandos executados, portanto, foram:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># Add Docker&#39;s official GPG key:</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>ca-certificates<span class="w"> </span>curl
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>sudo<span class="w"> </span>install<span class="w"> </span>-m<span class="w"> </span><span class="m">0755</span><span class="w"> </span>-d<span class="w"> </span>/etc/apt/keyrings
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>sudo<span class="w"> </span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://download.docker.com/linux/ubuntu/gpg<span class="w"> </span>-o<span class="w"> </span>/etc/apt/keyrings/docker.asc
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>sudo<span class="w"> </span>chmod<span class="w"> </span>a+r<span class="w"> </span>/etc/apt/keyrings/docker.asc
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="c1"># Add the repository to Apt sources:</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="nb">echo</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">  </span><span class="s2">&quot;deb [arch=</span><span class="k">$(</span>dpkg<span class="w"> </span>--print-architecture<span class="k">)</span><span class="s2"> signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="s2">  </span><span class="k">$(</span>.<span class="w"> </span>/etc/os-release<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UBUNTU_CODENAME</span><span class="k">:-</span><span class="nv">$VERSION_CODENAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2"> stable&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">  </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/docker.list<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>docker-ce<span class="w"> </span>docker-ce-cli<span class="w"> </span>containerd.io<span class="w"> </span>docker-buildx-plugin<span class="w"> </span>docker-compose-plugin<span class="w"> </span>
</span></code></pre></div>
<h2 id="configuracao-das-instancias-de-api"><b>Configuração das instâncias de API</b></h2>
<p align="justify">
Primeiramente, foram configuradas as variáveis de ambiente necessárias no arquivo .env. Aqui, além da URL para a interação com o banco de dados, também foram informadas as chaves necessárias para fazer as requisições para a API de cotação do dólar e do euro (um dos endpoints da aplicação):
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nv">AWESOME_API_KEY</span><span class="o">=</span><span class="s2">&quot;API_KEY_AQUI&quot;</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="nv">SECRET_KEY</span><span class="o">=</span><span class="s2">&quot;SECRET_KEY_AQUI&quot;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="nv">ALGORITHM</span><span class="o">=</span>HS256
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="nv">POSTGRES_USER</span><span class="o">=</span>cloud
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>senha
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="nv">POSTGRES_DB</span><span class="o">=</span>cloud
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="nv">DATABASE_URL</span><span class="o">=</span>postgresql://cloud:senha@<span class="o">[</span>IP<span class="w"> </span>de<span class="w"> </span>subrede<span class="w"> </span><span class="k">do</span><span class="w"> </span>Banco<span class="w"> </span>de<span class="w"> </span>Dados<span class="o">]</span>:5432/cloud
</span></code></pre></div>
<p align="justify">
Em seguida, a imagem do projeto publicada no docker hub foi puxada e o container foi executada nas duas instâncias.
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>sudo<span class="w"> </span>docker<span class="w"> </span>pull<span class="w"> </span>antoniolma/app
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>sudo<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>--env-file<span class="w"> </span>.env<span class="w"> </span>-d<span class="w"> </span>antoniolma/app
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="c1"># Verificando se o container está sendo executado na máquina</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>sudo<span class="w"> </span>docker<span class="w"> </span>ps<span class="w"> </span>-a
</span></code></pre></div>
<h2 id="configuracao-da-instancia-do-banco-de-dados"><b>Configuração da instância do Banco de Dados</b></h2>
<p align="justify">
Primeiramente, foi instalado o PostgreSQL por meio dos seguintes comandos:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>postgresql<span class="w"> </span>postgresql-contrib<span class="w"> </span>-y
</span></code></pre></div>
<p align="justify">
Em seguida, assim como feito nas APIs, foram configuradas as variáveis de ambiente necessárias no arquivo .env:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nv">POSTGRES_USER</span><span class="o">=</span>cloud
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>senha
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="nv">POSTGRES_DB</span><span class="o">=</span>cloud
</span></code></pre></div>
<p align="justify">
Por fim, foi executado o docker na porta padrão do postgres para que as instâncias de API possam enxergar o banco de dados:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>sudo<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5432</span>:5432<span class="w"> </span>--env-file<span class="w"> </span>.env<span class="w"> </span>-d<span class="w"> </span>postgres
</span></code></pre></div>
<h2 id="verificacao-final"><b>Verificação final</b></h2>
<p align="justify">
Para conferir o devido funcionamento da infraestrutura, foi criado um túnel SSH que conectasse o computador local a uma das instâncias de API criada. Para isso, foi executado o mesmo comando de túnel utilizado no roteiro 1, com as devidas adaptações necessárias:
</p>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>$<span class="w"> </span>ssh<span class="w"> </span>cloud@10.103.1.10<span class="w"> </span>-L<span class="w"> </span><span class="m">8080</span>:<span class="o">[</span>IP<span class="w"> </span>flutuante<span class="w"> </span>load-balancer<span class="o">]</span>:80<span class="w"> </span>
</span></code></pre></div>
<p><strong>Tarefa 4.2) Arquitetura de rede da infraestrutura dentro do Dashboard do OpenStack</strong></p>
<figure>
<p><a class="glightbox" href="../img/tarefa4_2.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Arquitetura de rede" src="../img/tarefa4_2.jpg" /></a></p>
<figcaption>
<p>Arquitetura de rede final</p>
</figcaption>
</figure>
<p><strong>Tarefa 4.3) Lista de VMs utilizadas com nome e IPs alocados,</strong></p>
<figure>
<p><a class="glightbox" href="../img/tarefa4_3.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Lista de VMs" src="../img/tarefa4_3.jpg" /></a></p>
<figcaption>
<p>Visualização dos nomes e IPs alocados via dashboard do Horizon</p>
</figcaption>
</figure>
<p><strong>Tarefa 4.4) Dashboard do FastAPI conectado via máquina Nginx/LB.</strong></p>
<figure>
<p><a class="glightbox" href="../img/tarefa4_4.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Dashboard FastAPI" src="../img/tarefa4_4.jpg" /></a></p>
<figcaption>
<p>Dashboard do FastAPI acessado após a aplicação do túnel SSH via máquina Nginx</p>
</figcaption>
</figure>
<p><strong>Tarefa 4.5) Servidores (máquina fisica) alocados para cada instância pelo OpenStack.</strong></p>
<figure>
<p><a class="glightbox" href="../img/tarefa4_5_load-balancer.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Alocação física do Load Balancer" src="../img/tarefa4_5_load-balancer.jpg" /></a></p>
<figcaption>
<p>Máquina física alocada para o Load Balancer pelo OpenStack: Server 5</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa4_5_api-1.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Alocação física da API 1" src="../img/tarefa4_5_api-1.jpg" /></a></p>
<figcaption>
<p>Máquina física alocada para a API 1 pelo OpenStack: Server 4</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa4_5_api-2.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Alocação física da API 2" src="../img/tarefa4_5_api-2.jpg" /></a></p>
<figcaption>
<p>Máquina física alocada para a API 2 pelo OpenStack: Server 2</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="../img/tarefa4_5_database.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Alocação física do Banco de Dados" src="../img/tarefa4_5_database.jpg" /></a></p>
<figcaption>
<p>Máquina física alocada para o Banco de dados Postgres pelo OpenStack: Server 3</p>
</figcaption>
</figure>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/javascripts/badge.js" async></script>
      
        <script src="../../termynal.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>